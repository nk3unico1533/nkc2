<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NK C2 Command</title>
    <style>
        :root { --bg: #050505; --term: #0a0a0a; --green: #00ff41; --text: #ddd; }
        body { background: var(--bg); color: var(--text); font-family: 'Courier New', monospace; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        header { padding: 15px; border-bottom: 1px solid #333; background: #000; display: flex; justify-content: space-between; align-items: center; }
        h1 { margin: 0; font-size: 1.2rem; color: var(--green); letter-spacing: 2px; }
        #log { flex: 1; overflow-y: auto; padding: 20px; font-size: 14px; background: var(--term); }
        .entry { margin-bottom: 5px; border-left: 2px solid transparent; padding-left: 10px; }
        .entry.sys { border-color: #333; color: #888; }
        .entry.res { border-color: var(--green); color: #fff; white-space: pre-wrap; }
        #controls { padding: 15px; background: #111; border-top: 1px solid #333; display: flex; gap: 10px; }
        input { flex: 1; background: #222; border: 1px solid #444; color: white; padding: 10px 15px; border-radius: 4px; font-family: inherit; }
        input:focus { outline: none; border-color: var(--green); }
        button { background: var(--green); color: black; border: none; padding: 0 25px; font-weight: bold; cursor: pointer; border-radius: 4px; }
        button:hover { opacity: 0.9; }
    </style>
</head>
<body>
    <header>
        <h1>NK // C2_NODE</h1>
        <div id="status" style="color: #555;">● DISCONNECTED</div>
    </header>
    
    <div id="log">
        <div class="entry sys">Initializing NK Web Interface...</div>
    </div>

    <div id="controls">
        <input id="cmd" type="text" placeholder="Enter shell command (whoami, ls -la, reboot)..." autofocus autocomplete="off">
        <button onclick="sendCommand()">EXECUTE</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const logDiv = document.getElementById('log');
        const statusDiv = document.getElementById('status');
        const cmdInput = document.getElementById('cmd');

        const addLog = (msg, type = 'res') => {
            const div = document.createElement('div');
            div.className = 'entry ' + type;
            div.innerText = msg;
            logDiv.appendChild(div);
            logDiv.scrollTop = logDiv.scrollHeight;
        };

        socket.on('connect', () => { 
            statusDiv.innerText = '● CONNECTED'; 
            statusDiv.style.color = '#00ff41';
            socket.emit('identify', { type: 'ui' }); 
        });

        socket.on('disconnect', () => {
            statusDiv.innerText = '● DISCONNECTED'; 
            statusDiv.style.color = 'red';
        });

        socket.on('log', (msg) => addLog(msg));

        const sendCommand = () => {
            const cmd = cmdInput.value.trim();
            if(!cmd) return;
            addLog('> ' + cmd, 'sys');
            socket.emit('cmd', { cmd });
            cmdInput.value = '';
        };

        cmdInput.addEventListener('keydown', (e) => { if(e.key === 'Enter') sendCommand(); });
    </script>
</body>
</html>
